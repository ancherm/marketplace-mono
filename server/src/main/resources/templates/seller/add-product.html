<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Добавление товара</title>
</head>
<body>
<h2>Добавление товара</h2>
<form th:action="@{/seller/product/add}" th:object="${product}" method="post" enctype="multipart/form-data">
    <div>
        <label for="name">Name:</label>
        <input type="text" id="name" th:field="*{name}" required />
    </div>
    <div>
        <label for="description">Description:</label>
        <textarea id="description" th:field="*{description}"></textarea>
    </div>
    <div>
        <label for="price">Price:</label>
        <input type="number" id="price" th:field="*{price}" step="0.01" required />
    </div>
    <div>
        <label for="quantity">Quantity:</label>
        <input type="number" id="quantity" th:field="*{quantity}" required />
    </div>
    <div>
        <label for="category">Category:</label>
        <select id="category" th:field="*{category.id}" required>
            <option th:each="category : ${categories}" th:value="${category.id}" th:text="${category.name}"></option>
        </select>
    </div>
    <div>
        <label for="file">Photo:</label>
        <input type="file" accept="image/*" id="file" name="file" required />
    </div>
<!--    <div id="attributes-container">-->
<!--        <label>Attributes:</label>-->
<!--        <div th:each="attribute, iterStat : ${product.attributes}">-->
<!--            <input type="text" th:field="*{attributes[__${iterStat.index}__].name}" placeholder="Attribute name" required />-->
<!--            <input type="text" th:field="*{attributes[__${iterStat.index}__].value}" placeholder="Attribute value" required />-->
<!--            <button type="button" th:if="${iterStat.size > 1}" onclick="removeAttribute(this)">Remove</button>-->
<!--        </div>-->
<!--        <button type="button" onclick="addAttribute()">Add Attribute</button>-->
<!--    </div>-->
    <div>
        <button type="submit">Add Product</button>
    </div>
</form>

<script>
    function addAttribute() {
        let container = document.getElementById('attributes-container');
        let totalAttributes = container.querySelectorAll('div').length;
        if (totalAttributes < 5) {
            let newAttributeDiv = document.createElement('div');
            let inputName = document.createElement('input');
            inputName.setAttribute('type', 'text');
            inputName.setAttribute('name', `attributes[${totalAttributes}].name`);
            inputName.setAttribute('placeholder', 'Attribute name');
            inputName.setAttribute('required', 'required');
            newAttributeDiv.appendChild(inputName);

            let inputValue = document.createElement('input');
            inputValue.setAttribute('type', 'text');
            inputValue.setAttribute('name', `attributes[${totalAttributes}].value`);
            inputValue.setAttribute('placeholder', 'Attribute value');
            inputValue.setAttribute('required', 'required');
            newAttributeDiv.appendChild(inputValue);

            let removeButton = document.createElement('button');
            removeButton.setAttribute('type', 'button');
            removeButton.setAttribute('onclick', 'removeAttribute(this)');
            removeButton.textContent = 'Remove';
            newAttributeDiv.appendChild(removeButton);

            container.insertBefore(newAttributeDiv, container.lastElementChild);
        } else {
            alert('Maximum 5 attributes allowed.');
        }
    }

    function removeAttribute(button) {
        let container = document.getElementById('attributes-container');
        let totalAttributes = container.querySelectorAll('div').length;
        if (totalAttributes > 1) {
            button.parentElement.remove();
        } else {
            alert('Minimum 1 attribute required.');
        }
    }
</script>
</body>
</html>
